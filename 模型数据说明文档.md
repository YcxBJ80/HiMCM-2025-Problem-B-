# HiMCM 2025 Problem B 能源评估模型数据说明文档

## 项目概述

本项目是一个基于分类熵权法的美国各州能源、交通和环境综合评估模型，用于为NFL比赛选址提供科学依据。模型采用两阶段熵权法：首先在7个分类内计算指标权重，然后合并各分类分数得到最终综合评分。

## 数据源总览

### 1. 主要数据来源

项目使用来自美国能源信息署(EIA)和其他官方来源的多种能源、环境和交通数据，主要包含以下Excel文件：

#### 能源相关数据
- **Btu 的一次能源生产 – 可再生能源和总能源.xlsx**：可再生能源和总能源生产数据
- **Btu 的一次能源生产——化石燃料和核能.xlsx**：化石燃料和核能生产数据
- **以物理单位计算的一次能源生产——化石燃料和核能.xlsx**：物理单位的一次能源生产数据
- **物理单元的一次能源生产——生物燃料.xlsx**：生物燃料生产数据
- **按来源划分的一次能源消耗.xlsx**：按能源来源划分的一次能源消耗
- **按来源划分的可再生能源消费.xlsx**：可再生能源消费数据
- **按最终用途部门划分的总能源消耗.xlsx**：按部门划分的能源消耗
- **按最终用途部门分列的人均能源消耗总量.xlsx**：人均能源消耗数据

#### 价格和支出数据
- **能源总价格和支出（总额、人均和每 GDP）.xlsx**：能源价格和支出综合数据
- **向最终客户销售煤炭和电力的价格和支出.xlsx**：煤炭和电力价格支出
- **向最终客户销售电力、总和住宅、总和人均.xlsx**：电力销售价格和支出
- **石油和天然气价格和支出.xlsx**：石油和天然气价格支出
- **车用汽油价格和支出.xlsx**：车用汽油价格支出
- **按最终用途部门分列的能源总支出.xlsx**：按部门划分的能源支出
- **按最终用途部门划分的能源总价格.xlsx**：按部门划分的能源价格

#### 排放和环境数据
- **CO2 总排放量、人均 CO2 排放量和碳强度.xlsx**：CO2排放相关指标
- **按来源划分的二氧化碳排放总量.xlsx**：按能源来源划分的CO2排放
- **按部门划分的二氧化碳排放总量.xlsx**：按部门划分的CO2排放
- **能源系列指标.xlsx**：包含GDP、能源强度、冷却度日(CDD)等综合指标
- **副本环境数据汇总.xlsx**：城市水资源使用和航空出行数据

#### 其他数据文件
- **State Waste Data.xlsx**：州级废弃物管理数据
- **airports.dat**：机场数据文件
- **NTD Annual Data 2022-2024.csv**：公共交通年度数据
- **nfl_stadium_capacity.csv**：NFL体育场容量数据
- **state_transport_stats.csv**：州级交通统计数据

## 数据分类结构

### 指标分类体系

模型将所有指标按照业务逻辑分为7个主要分类，每个分类包含相关领域的多个指标：

#### 1. 能源消费类 (Energy Consumption)
包含各种能源的生产、消费和使用指标：
- 石油产品总消费量和人均消费
- 天然气总消费量和人均消费
- 煤炭消费和生产
- 核能发电消费
- 可再生能源消费（生物质能、木柴和废弃物等）
- 生物燃料生产
- 各部门能源消费（商业、工业、住宅、交通等）
- 能源强度（GDP能源消费比）

#### 2. 能源价格类 (Energy Prices)
包含能源价格和支出相关指标：
- 煤炭平均价格和总支出
- 电力平均价格和总支出
- 石油和天然气价格和支出
- 车用汽油价格和支出
- 各部门能源平均价格
- 人均能源支出
- 每GDP能源支出

#### 3. 碳排放类 (Carbon Emissions)
包含CO2排放相关指标：
- 总能源CO2排放量
- 人均CO2排放量
- 碳强度（CO2排放量除以能源消费）
- 经济碳强度（CO2排放量除以实际GDP）
- 按能源来源划分的CO2排放（煤炭、石油、天然气等）
- 按部门划分的CO2排放（电力、商业、工业等）

#### 4. 经济人口类 (Economic & Demographic)
包含经济和人口统计指标：
- 当前美元GDP
- 实际GDP（用于计算碳强度）
- 人口数据（通过人均指标间接获取）

#### 5. 气候环境类 (Climate & Environment)
包含气候和环境相关指标：
- 冷却度日(CDD)：衡量空调需求，反映气候条件
- 其他气候环境指标

#### 6. 城市水资源类 (Urban Water Resources)
来自城市水资源使用数据：
- 公共供水用水量
- 灌溉用水量
- 工业用水量
- 火力发电用水量
- 总用水量

#### 7. 航空出行类 (Air Travel)
来自FAA机场客运数据：
- 商业机场数量
- 商业登机旅客量（2023年和2022年）
- 登机旅客增长率

### 预留分类（待启用）

#### 废弃物管理类 (Waste Management)
- 目前有州级废弃物数据，但暂未纳入模型
- 等待更多州级废弃物物流向数据后启用

## 数据结构和格式

### 时间序列数据格式

大部分能源和排放数据为时间序列格式：
- **行**：各州（50个州 + 哥伦比亚特区）
- **列**：年份（1960-2023年）
- **示例**：
  ```
  State | 1960 | 1961 | ... | 2022 | 2023
  AK    | 2.0  | ...  | 13.0 | 19.0
  AL    | 1819 | ...  | 2042 | 2061
  ```

### 截面数据格式

部分环境数据为单年截面数据（主要为2023年）：
- **航空出行数据**：包含机场排名、州代码、城市、机场名称、枢纽类型、登机旅客量等
- **城市水资源数据**：包含都市统计区代码、名称、各类型用水量

### 数据质量和覆盖情况

#### 时间覆盖范围
- 大部分能源数据：1960-2023年（63年）
- 价格支出数据：1970-2023年（53年）
- GDP相关数据：1997-2023年（26年）
- 环境外部数据：2023年

#### 州覆盖情况
- 50个州 + 哥伦比亚特区(DC)
- 总观测数：每个指标约3300-3400个州-年观测值

#### 数据完整性
- 模型设置最小特征覆盖率：85%（至少85%的州有该指标数据）
- 最小州覆盖率：80%（对州评分时至少80%的指标有数据）

## 数据处理流程

### 1. 数据加载和清洗
- 自动扫描所有Excel文件的工作表
- 提取指标名称、单位、时间范围
- 标准化州代码和年份格式
- 处理缺失值和异常值

### 2. 指标分类
- 根据指标名称自动分类到相应类别
- 使用关键词匹配和排除规则
- 生成指标分类映射表

### 3. 特征矩阵构建
- 提取指定年份（默认2023年）的数据
- 按州和指标构建特征矩阵
- 过滤低覆盖率的指标和州

### 4. 分类内熵权计算
对每个分类：
- 筛选该分类的指标
- 标准化数据（benefit/cost方向）
- 计算指标权重（基于信息熵）
- 计算分类分数

### 5. 分类间合并
- 将各分类分数作为新指标
- 再次使用熵权法计算分类权重
- 加权合并得到综合分数

## 模型输出说明

### 主要输出文件

#### 1. 分类分数文件
- `state_scores_能源消费类_2023.csv`
- `state_scores_能源价格类_2023.csv`
- `state_scores_碳排放类_2023.csv`
- `state_scores_经济人口类_2023.csv`
- `state_scores_气候环境类_2023.csv`
- `state_scores_城市水资源类_2023.csv`
- `state_scores_航空出行类_2023.csv`

#### 2. 综合分数文件
- `state_scores_categorized_2023.csv`：最终综合分数（0-100分）

#### 3. 权重文件
- `category_indicator_weights_2023.csv`：各分类内指标权重
- `category_merge_weights_2023.csv`：分类合并权重

#### 4. 模型配置
- `category_models_2023.json`：各分类的标准化参数和权重
- `categorized_summary_2023.json`：模型摘要信息

### 分类权重分析

2023年模型的分类权重分布：

| 分类 | 权重 | 说明 |
|------|------|------|
| 比赛间交通时间类 | 25.37% | 最高权重，反映交通便捷性对比赛选址的重要性 |
| 比赛因素类 | 18.87% | 体育场相关因素 |
| 航空出行类 | 13.29% | 航空交通便利性 |
| 经济人口类 | 12.72% | 经济规模和人口基础 |
| 能源消费类 | 9.33% | 能源消费水平 |
| 废弃物管理类 | 8.42% | 废弃物管理能力 |
| 碳排放类 | 5.15% | 碳排放水平 |
| 气候环境类 | 5.36% | 气候环境条件 |
| 能源价格类 | 0.70% | 能源价格水平 |
| 城市水资源类 | 0.79% | 水资源使用情况 |

### 综合评分结果

各州综合评分示例（前10名）：

| 排名 | 州 | 分数 | 说明 |
|------|----|------|------|
| 1 | CA | 100.0 | 加利福尼亚州，得分最高 |
| 2 | TX | 92.5 | 德克萨斯州 |
| 3 | NY | 77.4 | 纽约州 |
| 4 | WA | 77.2 | 华盛顿州 |
| 5 | FL | 72.3 | 佛罗里达州 |
| 6 | NV | 70.9 | 内华达州 |
| 7 | AZ | 61.3 | 亚利桑那州 |
| 8 | MA | 54.9 | 马萨诸塞州 |
| 9 | CO | 52.1 | 科罗拉多州 |
| 10 | PA | 49.9 | 宾夕法尼亚州 |

## 数据使用建议

### 1. 指标方向说明
- **Benefit类型**（越高越好）：GDP、经济增长、能源效率等
- **Cost类型**（越低越好）：价格、排放、能源消费等

### 2. 数据更新频率
- 能源和排放数据：年度更新
- 价格数据：年度更新
- 环境数据：视数据源更新频率而定

### 3. 扩展建议
- 可以添加更多环境指标（如空气质量、绿色空间等）
- 可以纳入交通基础设施数据
- 可以考虑季节性因素对能源消费的影响

## 技术说明

### 数据处理技术栈
- **Python**：主要编程语言
- **pandas**：数据处理和分析
- **openpyxl**：Excel文件读取
- **numpy**：数值计算

### 质量控制
- 自动检测和处理缺失值
- 标准化州代码格式
- 验证数据一致性
- 生成数据质量报告

---

**文档版本**: 1.0
**最后更新**: 2025年11月
**数据年份**: 2023年
**模型类型**: 分类熵权法
